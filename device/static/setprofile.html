<!doctype html>
<html ng-app>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>
    </head>
    <body>
    
        <h2>Select Profile</h2>
        
        <select id="profilelist" name="profile">
                <option value="addrestriction" type="text">Features</option>
                <option value="addmanagedemail" type="text">Email Configation</option>
        </select>
        <br><br>

        <div id="restriction_info_div" style="display: block;">
            <h2>Enable/Disable Features</h2>
            <input id="camera" type="checkbox" name="camera" >Camera<br>
            <input id="docsharing" type="checkbox" name="docsharing" >Document Sharing <br>
            <input id="screeshot" type="checkbox" name="screeshot" >Alow Screen shot<br>

            <p><button  onclick="sendRestrictionDetails()">Submit</button></p>
    
        </div>

        <div id="email_info_div" style="display: none;">
            <h1>Email Profile</h1>

            <p>Profile Name <input type="text" id="profileName" name="" value="My Email Profile"/></p>
            <p>Email Account Description<input type="text" id="EmailAccountDescription" name="EmailAccountDescription"/></p>
              <p>Account Display <input type="text" id="AccountDisplay" name="AccountDisplay"/></p>
            
              <p>Account Type
                <select id="accountType">
                    <option value="EmailTypeIMAP">IMAP
                    <option value="EmailTypePOP">POP
                </select>
              </p>
              
                <p>Path Prefix <input type="text" id="pathprefix" name="pathprefix"/></p>  
                
                <p>Sender Name <input type="text" id="senderName" name="senderName"/>
                            <label>Note: type email ID </label>
                </p>
                
                    <p>Sender E-Mail Address <input type="text" id="senderEmail" name="senderEmail"/>
                        <label>Note: type email ID </label>
                    </p>
                      
                <p>Prevent Moving Messages to other Mail Accounts
                <select id="preventMovingMsgMailAcc">
                    <option value=false>No
                    <option value=true>Yes
                </select>
              </p>
                <p>Disable recent mail address sync
                <select id="disableRecentMailSync">
                    <option value=false>No
                    <option value=true>Yes
                </select>
              </p>
            <hr>
            <h2>Incoming Mail </h2>
            
             <p>Mail Server 
             <input type="text" id="incmgMailserver" name="incmgMailserver"/>
             </p>
             
              <p>Port 
             <input type="text" id="incmgMailserverPort" name="incmgMailserverPort"/>
             </p>
             
              <p>User Name
             <input type="text" id="incmgMailserverUsrName" name="incmgMailserverUsrName"/>
             <label>Note: type email ID </label>
             </p>
             
               <p>Authentication Type	 
                 <select id="incmgMailserverAthuType">
                    <option value="EmailAuthNone">None
                </select>
             </p>
             
                <p>Use SSL for mail communication	
                <select id="incmgMailserverSsl">
                    <option value=true>Yes
                    <option value=false>No
                </select>
              </p>
            
            
            <hr>
            <h2>Outgoing Mail </h2>
            
             <p>Mail Server 
             <input type="text" id="outgoingMailserver" name="outgoingMailserver"/>
             </p>
             
              <p>Port 
             <input type="text" id="outgoingMailserverPort" name="outgoingMailserverPort"/>
             </p>
             
              <p>User Name
             <input type="text" id="outgoingMailserverUsrName" name="outgoingMailserverUsrName"/>
             <label>Note: type email ID </label>
             </p>
             
               <p>Authentication Type	 
                 <select id="outgoingMailserverAthuType">
                    <option value="EmailAuthNone">None
                </select>
             </p>
             
                <p>Use SSL for mail communication	
                <select id="outgoingMailserverSsl">
                    <option value=true>Yes
                    <option value=false>No
                </select>
              </p>
            
                <p>Use Outgoing Password Same as Incoming	
                <select id="outgoingIncomingMailserverSamePass">
                    <option value=true>Yes
                    <option value=false>No
                </select>
              </p>
              
              
                  <p>Block Account usage from non-Mail Apps
                <select id="blockAccUsgFrmNonMailApps">
                    <option value=false>No
                    <option value=true>Yes
                </select>
              </p>
              
                  <p>Enable S/MIME to encrypt or decrypt Mails	
                <select id="enableCrypto">
                    <option value=false>No
                    <option value=true>Yes
                </select>
              </p>
              <hr>
            <p><button  onclick="sendEmailAccDetails()">Configure</button></p>
        </div>

        

        
        <script>
           
           document.getElementById('profilelist').addEventListener('change', function () {
                var style = this.value == "addmanagedemail" ? 'block' : 'none';
                document.getElementById('email_info_div').style.display = style;
                style = this.value == "addrestriction" ? 'block' : 'none';
                document.getElementById('restriction_info_div').style.display = style;
            });


            function sendRestrictionDetails() {

                xhttp = new XMLHttpRequest();
                var url = "/meem/device/apple/profiles/restrictions";
                xhttp.open("POST", url, true);
                xhttp.setRequestHeader("Content-type", "application/json");
                xhttp.onreadystatechange = function () { 
                    if (xhttp.readyState == XMLHttpRequest.DONE && xhttp.status == 200) {
                        
                        alert(xhttp.responseText);
                    }
                    else if (xhttp.readyState == XMLHttpRequest.DONE) {
                        alert(xhttp.responseText);
                    }
                }

                var tokenID =sessionStorage.getItem("token", tokenID);


                var data = JSON.stringify({
                    "tokenID": tokenID,
                    "camera" : document.getElementById("camera").checked?"yes":"no",  
                    "docsharing" : document.getElementById("docsharing").checked?"yes":"no", 
                    "screeshot" : document.getElementById("screeshot").checked?"yes":"no" 
                  
                });

                xhttp.send(data);

            }

            function sendEmailAccDetails() {
    
                alert("email");
                var eamilPylaodversion = 1;
                var profilePylaodversion = 1;
                var profilename = document.getElementById("profileName").value;
                var emailAccDesc = document.getElementById("EmailAccountDescription").value;
                var accDisp = document.getElementById("AccountDisplay").value;
                var accType = document.getElementById("accountType").value;
                var pathPrefix = document.getElementById("pathprefix").value;
                var senderName = document.getElementById("senderName").value;
                var senderEmail = document.getElementById("senderEmail").value;
                var mvMails = document.getElementById("preventMovingMsgMailAcc").value;
                var disableSync = document.getElementById("disableRecentMailSync").value;
  
  
                var incmgMailserver =document.getElementById("incmgMailserver").value;
                var incmgPort = document.getElementById("incmgMailserverPort").value;
                var incmgusrName = document.getElementById("incmgMailserverUsrName").value;
                var incmgAuthType = document.getElementById("incmgMailserverAthuType").value;
                var incmgAuthSsl =  document.getElementById("incmgMailserverSsl").value;

                var outgoingMailserver = document.getElementById("outgoingMailserver").value;
                var outgoingPort = document.getElementById("outgoingMailserverPort").value;
                var outgoingUsrName = document.getElementById("outgoingMailserverUsrName").value;
                var outgoingAuthType = document.getElementById("outgoingMailserverAthuType").value;
                var outgoingSsl = document.getElementById("outgoingMailserverSsl").value;
                var samePass = document.getElementById("outgoingIncomingMailserverSamePass").value;
                var blockNonMailapps = document.getElementById("blockAccUsgFrmNonMailApps").value;
                var enableCrypto = document.getElementById("enableCrypto").value;


                xhttp = new XMLHttpRequest();
                var url = "/meem/device/apple/profiles/email";
                xhttp.open("POST", url, true);
                xhttp.setRequestHeader("Content-type", "application/json");
                xhttp.onreadystatechange = function () { 
                    if (xhttp.readyState == XMLHttpRequest.DONE && xhttp.status == 200) {
                        
                        alert(xhttp.responseText);
                    }
                    else if (xhttp.readyState == XMLHttpRequest.DONE) {
                        alert(xhttp.responseText);
                    }
                }

                var tokenID =sessionStorage.getItem("token", tokenID);

                var data = JSON.stringify({
                    "tokenID": tokenID,
                    "profielName" : profilename,  
                    "org" : "Meem Memory pvt ltd",   
                    "eamilPayloadVer" : eamilPylaodversion,
                    "profilePayloadVer" : profilePylaodversion, 
                    "EmailAccountDescription" : emailAccDesc,
                    "AccountDisplay":accDisp,
                    "accountType":accType,
                    "pathprefix":pathPrefix,
                    "senderName":senderName,
                    "senderEmail":senderEmail,
                    "preventMovingMsgMailAcc":mvMails,
                    "disableRecentMailSync":disableSync,

                    "incoming":{
                        "mailServer": incmgMailserver,
                        "port": incmgPort,
                        "userName": incmgusrName,
                        "authType": incmgAuthType,
                        "ssl": incmgAuthSsl
                    },
                    "outgoing":{
                        "mailServer" : outgoingMailserver,
                        "port" : outgoingPort,
                        "userName" : outgoingUsrName,
                        "authType" : outgoingAuthType,
                        "ssl" :outgoingSsl,
                        "outgoingIncomingMailserverSamePass" : samePass,
                        "blockAccUsgFrmNonMailApps" : blockNonMailapps,
                        "enableCrypto" : enableCrypto
                    }      
                });
                alert("email2");
                xhttp.send(data);

            }
        
        </script>
    
    
    </body>
</html>